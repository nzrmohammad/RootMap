<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù¾Ø±ÙˆÚ˜Ù‡ Ø±ÛŒØ´Ù‡ - Ø´Ø¬Ø±Ù‡â€ŒÙ†Ø§Ù…Ù‡ ØªØ¹Ø§Ù…Ù„ÛŒ</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;700&display=swap');

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Ù¾Ù†Ù„ Ø§ØµÙ„ÛŒ Ú¯Ø±Ø§Ù */
        #network-container {
            flex-grow: 1;
            position: relative;
            background: #fff;
        }

        #mynetwork {
            width: 100%;
            height: 100%;
            border-left: 1px solid #ddd;
        }

        /* Ù¾Ù†Ù„ Ø¬Ø²Ø¦ÛŒØ§Øª (Sidebar) */
        #sidebar {
            width: 320px;
            background: #ffffff;
            box-shadow: -2px 0 10px rgba(0,0,0,0.05);
            padding: 20px;
            display: flex;
            flex-direction: column;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .header {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h2 { margin: 0; color: #2c3e50; }
        .header p { color: #7f8c8d; font-size: 0.9em; }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ */
        .profile-card {
            text-align: center;
            display: none; /* Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù…Ø®ÙÛŒ */
            animation: fadeIn 0.5s;
        }
        
        .profile-img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #eee;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: #aaa;
            border: 3px solid #3498db;
        }

        .profile-name { font-weight: bold; font-size: 1.2em; color: #2c3e50; margin-bottom: 5px; }
        .profile-role { color: #e67e22; font-size: 0.9em; margin-bottom: 15px; font-weight: bold; }
        
        .data-row {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #eee;
            padding: 10px 0;
            font-size: 0.9em;
        }
        
        .data-label { color: #7f8c8d; }
        .data-value { font-weight: 500; }

        .search-box {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 20px;
            font-family: 'Vazirmatn';
        }

        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ */
        .controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        .btn {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .btn:hover { background: #34495e; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <div class="header">
            <h2>ğŸŒ³ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±ÛŒØ´Ù‡</h2>
            <p>Ø´Ø¬Ø±Ù‡â€ŒÙ†Ø§Ù…Ù‡ Ø®Ø§Ù†Ø¯Ø§Ù† Ø¨Ø²Ø±Ú¯</p>
        </div>

        <input type="text" id="search" class="search-box" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù…..." onkeyup="searchNode()">

        <div id="empty-state" style="text-align: center; color: #999; margin-top: 50px;">
            <i class="fas fa-mouse-pointer" style="font-size: 40px; margin-bottom: 10px;"></i>
            <p>Ø±ÙˆÛŒ ÛŒÚ©ÛŒ Ø§Ø² Ø§Ø¹Ø¶Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ù…Ø´Ø®ØµØ§ØªØ´ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯.</p>
        </div>

        <div id="profile-card" class="profile-card">
            <div class="profile-img" id="p-img"><i class="fas fa-user"></i></div>
            <div class="profile-name" id="p-name">Ù†Ø§Ù… ÙØ±Ø¯</div>
            <div class="profile-role" id="p-role">Ù†Ø³Ø¨Øª</div>
            
            <div class="data-row">
                <span class="data-label">Ø³Ø§Ù„ ØªÙˆÙ„Ø¯:</span>
                <span class="data-value" id="p-birth">1360</span>
            </div>
            <div class="data-row">
                <span class="data-label">Ø´ØºÙ„:</span>
                <span class="data-value" id="p-job">Ø¢Ø²Ø§Ø¯</span>
            </div>
            <div class="data-row">
                <span class="data-label">Ù…Ø­Ù„ Ø³Ú©ÙˆÙ†Øª:</span>
                <span class="data-value" id="p-loc">ØªÙ‡Ø±Ø§Ù†</span>
            </div>
            <div style="margin-top: 20px; text-align: justify; font-size: 0.85em; line-height: 1.6; color: #555;" id="p-bio">
                ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø®ØªØµØ± Ø¯Ø± Ù…ÙˆØ±Ø¯ ÙØ±Ø¯ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯...
            </div>
        </div>
    </div>

    <div id="network-container">
        <div id="mynetwork"></div>
        <div class="controls">
            <button class="btn" onclick="network.fit()"><i class="fas fa-compress"></i> ØªÙ…Ø§Ù… ØµÙØ­Ù‡</button>
            <button class="btn" onclick="toggleLayout()"><i class="fas fa-sitemap"></i> ØªØºÛŒÛŒØ± Ú†ÛŒØ¯Ù…Ø§Ù†</button>
        </div>
    </div>

<script type="text/javascript">
    // --- 1. Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒ Ú†Ù†Ø¯ Ù‡Ù…Ø³Ø±ÛŒ Ø±Ø§ ØªØ³Øª Ú©Ù†ÛŒ) ---
    // level: 0 (Ù¾Ø¯Ø±Ø¨Ø²Ø±Ú¯â€ŒÙ‡Ø§)ØŒ 1 (Ù¾Ø¯Ø±Ù‡Ø§)ØŒ 2 (Ø¨Ú†Ù‡â€ŒÙ‡Ø§) -> Ø¨Ø±Ø§ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù† Ø¯Ø±Ø®ØªÛŒ Ù…Ù‡Ù… Ø§Ø³Øª
    
    const nodesArray = [
        // Ù†Ø³Ù„ Ø§ÙˆÙ„ (Ø±ÛŒØ´Ù‡)
        {id: 1, label: 'Ø­Ø§Ø¬ Ø§Ø­Ù…Ø¯\n(Ø¨Ø²Ø±Ú¯ Ø®Ø§Ù†Ø¯Ø§Ù†)', level: 0, group: 'male', info: {birth: '1300', job: 'Ú©Ø´Ø§ÙˆØ±Ø²', loc: 'Ø±ÙˆØ³ØªØ§', bio: 'Ø¨Ù†ÛŒØ§Ù†â€ŒÚ¯Ø°Ø§Ø± Ø®Ø§Ù†Ø¯Ø§Ù†.'}},
        // Ù‡Ù…Ø³Ø±Ø§Ù†
        {id: 2, label: 'Ø¨ÛŒâ€ŒØ¨ÛŒ Ø³Ú©ÛŒÙ†Ù‡\n(Ù‡Ù…Ø³Ø± Ø§ÙˆÙ„)', level: 0, group: 'female', info: {birth: '1305', job: 'Ø®Ø§Ù†Ù‡â€ŒØ¯Ø§Ø±', loc: 'Ø±ÙˆØ³ØªØ§', bio: ''}},
        {id: 3, label: 'Ø¨ÛŒâ€ŒØ¨ÛŒ Ù…Ø±ÛŒÙ…\n(Ù‡Ù…Ø³Ø± Ø¯ÙˆÙ…)', level: 0, group: 'female', info: {birth: '1315', job: 'Ù…Ø¹Ù„Ù…', loc: 'Ø´Ù‡Ø±', bio: ''}},

        // Ù†Ø³Ù„ Ø¯ÙˆÙ… (ÙØ±Ø²Ù†Ø¯Ø§Ù† Ù‡Ù…Ø³Ø± Ø§ÙˆÙ„)
        {id: 4, label: 'Ø­Ø³Ù†\n(Ù¾Ø¯Ø±)', level: 1, group: 'male', info: {birth: '1340', job: 'Ú©Ø§Ø±Ù…Ù†Ø¯', loc: 'ØªÙ‡Ø±Ø§Ù†', bio: 'Ù¾Ø³Ø± Ø§Ø±Ø´Ø¯ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡'}},
        {id: 5, label: 'Ø­Ø³ÛŒÙ†\n(Ø¹Ù…Ùˆ)', level: 1, group: 'male', info: {birth: '1342', job: 'Ø¨Ø§Ø²Ù†Ø´Ø³ØªÙ‡', loc: 'Ø§ØµÙÙ‡Ø§Ù†', bio: ''}},
        
        // Ù†Ø³Ù„ Ø¯ÙˆÙ… (ÙØ±Ø²Ù†Ø¯Ø§Ù† Ù‡Ù…Ø³Ø± Ø¯ÙˆÙ…)
        {id: 6, label: 'Ø²Ù‡Ø±Ø§\n(Ø¹Ù…Ù‡)', level: 1, group: 'female', info: {birth: '1350', job: 'Ù¾Ø²Ø´Ú©', loc: 'Ø´ÛŒØ±Ø§Ø²', bio: ''}},

        // Ù‡Ù…Ø³Ø± Ù¾Ø¯Ø± Ù…Ù†
        {id: 7, label: 'Ù…Ø§Ø¯Ø± Ù…Ù†', level: 1, group: 'female', info: {birth: '1345', job: 'Ø®Ø§Ù†Ù‡â€ŒØ¯Ø§Ø±', loc: 'ØªÙ‡Ø±Ø§Ù†', bio: ''}},

        // Ù†Ø³Ù„ Ø³ÙˆÙ… (Ù†ÙˆÙ‡â€ŒÙ‡Ø§)
        {id: 8, label: 'Ù…Ù† (Ø¹Ù„ÛŒ)', level: 2, group: 'me', info: {birth: '1370', job: 'Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³', loc: 'ØªÙ‡Ø±Ø§Ù†', bio: 'ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡ Ù‡Ù…ÛŒÙ† Ø³Ø§ÛŒØª!'}},
        {id: 9, label: 'Ø³Ø§Ø±Ø§\n(Ø®ÙˆØ§Ù‡Ø±)', level: 2, group: 'female', info: {birth: '1375', job: 'Ø¯Ø§Ù†Ø´Ø¬Ùˆ', loc: 'ØªÙ‡Ø±Ø§Ù†', bio: ''}},
        {id: 10, label: 'Ø±Ø¶Ø§\n(Ù¾Ø³Ø± Ø¹Ù…Ù‡)', level: 2, group: 'male', info: {birth: '1372', job: 'Ù…Ø¹Ù…Ø§Ø±', loc: 'Ø´ÛŒØ±Ø§Ø²', bio: ''}},
    ];

    const edgesArray = [
        // Ø§Ø²Ø¯ÙˆØ§Ø¬â€ŒÙ‡Ø§ÛŒ Ø­Ø§Ø¬ Ø§Ø­Ù…Ø¯
        {from: 1, to: 2, label: 'Ø§Ø²Ø¯ÙˆØ§Ø¬', dashes: true, color: '#aaa'},
        {from: 1, to: 3, label: 'Ø§Ø²Ø¯ÙˆØ§Ø¬', dashes: true, color: '#aaa'},

        // ÙØ±Ø²Ù†Ø¯Ø§Ù† Ø­Ø§Ø¬ Ø§Ø­Ù…Ø¯ Ùˆ Ø³Ú©ÛŒÙ†Ù‡ (Ù‡Ù…Ø³Ø± Ø§ÙˆÙ„)
        {from: 1, to: 4}, 
        {from: 2, to: 4}, // Ø­Ø³Ù† ÙØ±Ø²Ù†Ø¯ Ø³Ú©ÛŒÙ†Ù‡ Ø§Ø³Øª
        {from: 1, to: 5}, 
        {from: 2, to: 5}, // Ø­Ø³ÛŒÙ† ÙØ±Ø²Ù†Ø¯ Ø³Ú©ÛŒÙ†Ù‡ Ø§Ø³Øª

        // ÙØ±Ø²Ù†Ø¯Ø§Ù† Ø­Ø§Ø¬ Ø§Ø­Ù…Ø¯ Ùˆ Ù…Ø±ÛŒÙ… (Ù‡Ù…Ø³Ø± Ø¯ÙˆÙ…)
        {from: 1, to: 6}, 
        {from: 3, to: 6}, // Ø²Ù‡Ø±Ø§ ÙØ±Ø²Ù†Ø¯ Ù…Ø±ÛŒÙ… Ø§Ø³Øª

        // Ø§Ø²Ø¯ÙˆØ§Ø¬ Ù¾Ø¯Ø± Ùˆ Ù…Ø§Ø¯Ø±
        {from: 4, to: 7, label: 'Ø§Ø²Ø¯ÙˆØ§Ø¬', dashes: true, color: '#aaa'},

        // ÙØ±Ø²Ù†Ø¯Ø§Ù† Ù¾Ø¯Ø± Ùˆ Ù…Ø§Ø¯Ø±
        {from: 4, to: 8}, {from: 7, to: 8}, // Ù…Ù†
        {from: 4, to: 9}, {from: 7, to: 9}, // Ø®ÙˆØ§Ù‡Ø±

        // ÙØ±Ø²Ù†Ø¯Ø§Ù† Ø¹Ù…Ù‡
        {from: 6, to: 10}, // Ù¾Ø³Ø± Ø¹Ù…Ù‡
    ];

    // --- 2. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú¯Ø±Ø§ÙÛŒÚ© (Vis.js) ---
    var nodes = new vis.DataSet(nodesArray);
    var edges = new vis.DataSet(edgesArray);

    var container = document.getElementById('mynetwork');
    var data = { nodes: nodes, edges: edges };

    var options = {
        nodes: {
            shape: 'box',
            margin: 10,
            widthConstraint: { maximum: 120 },
            font: { face: 'Vazirmatn', multi: 'html', size: 16 },
            borderWidth: 0,
            shadow: true
        },
        edges: {
            width: 2,
            smooth: { type: 'cubicBezier', forceDirection: 'vertical', roundness: 0.4 },
            arrows: { to: { enabled: true, scaleFactor: 0.5 } },
            color: { color: '#bdc3c7', highlight: '#2c3e50' }
        },
        layout: {
            hierarchical: {
                direction: 'UD', // Up-Down (Ø§Ø² Ø¨Ø§Ù„Ø§ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ†)
                sortMethod: 'directed', // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¬Ù‡Øª ÙÙ„Ø´â€ŒÙ‡Ø§
                nodeSpacing: 150,
                levelSeparation: 150
            }
        },
        groups: {
            male: { color: { background: '#ebf5fb', border: '#3498db' }, font: { color: '#2980b9' }, shapeProperties: { borderRadius: 4 } },
            female: { color: { background: '#fdedec', border: '#e74c3c' }, font: { color: '#c0392b' }, shapeProperties: { borderRadius: 50 } }, // Ú¯Ø±Ø¯ØªØ± Ø¨Ø±Ø§ÛŒ Ø®Ø§Ù†Ù…â€ŒÙ‡Ø§
            me: { color: { background: '#fff9c4', border: '#f1c40f' }, font: { size: 18, color: '#d35400' }, borderWidth: 2 }
        },
        interaction: { hover: true, tooltipDelay: 200 }
    };

    var network = new vis.Network(container, data, options);

    // --- 3. Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© (Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±) ---
    network.on("click", function (params) {
        if (params.nodes.length > 0) {
            var nodeId = params.nodes[0];
            var person = nodes.get(nodeId);
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±
            document.getElementById('empty-state').style.display = 'none';
            document.getElementById('profile-card').style.display = 'block';
            
            document.getElementById('p-name').innerText = person.label.replace('\n', ' ');
            document.getElementById('p-role').innerText = getRoleName(person.group);
            document.getElementById('p-birth').innerText = person.info.birth;
            document.getElementById('p-job').innerText = person.info.job;
            document.getElementById('p-loc').innerText = person.info.loc;
            document.getElementById('p-bio').innerText = person.info.bio || 'ØªÙˆØ¶ÛŒØ­Ø§Øª ØªÚ©Ù…ÛŒÙ„ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.';

            // ØªØºÛŒÛŒØ± Ø¢ÛŒÚ©ÙˆÙ† Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¬Ù†Ø³ÛŒØª
            const iconDiv = document.getElementById('p-img');
            if (person.group === 'female') {
                iconDiv.innerHTML = '<i class="fas fa-female" style="color: #e74c3c"></i>';
                iconDiv.style.borderColor = '#e74c3c';
            } else {
                iconDiv.innerHTML = '<i class="fas fa-male" style="color: #3498db"></i>';
                iconDiv.style.borderColor = '#3498db';
            }

        } else {
            // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ÙØ¶Ø§ÛŒ Ø®Ø§Ù„ÛŒ
            document.getElementById('empty-state').style.display = 'block';
            document.getElementById('profile-card').style.display = 'none';
        }
    });

    function getRoleName(group) {
        if(group === 'me') return 'Ú©Ø§Ø±Ø¨Ø± Ø§ØµÙ„ÛŒ';
        if(group === 'female') return 'Ø¹Ø¶Ùˆ Ù…ÙˆÙ†Ø« Ø®Ø§Ù†Ø¯Ø§Ù†';
        return 'Ø¹Ø¶Ùˆ Ù…Ø°Ú©Ø± Ø®Ø§Ù†Ø¯Ø§Ù†';
    }

    // --- 4. ØªØ§Ø¨Ø¹ Ø¬Ø³ØªØ¬Ùˆ ---
    function searchNode() {
        var query = document.getElementById('search').value.toLowerCase();
        var allNodes = nodes.get();
        
        // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù†ÙˆØ¯
        var foundNode = allNodes.find(n => n.label.replace('\n', ' ').toLowerCase().includes(query));
        
        if (foundNode && query.length > 0) {
            network.selectNodes([foundNode.id]);
            network.focus(foundNode.id, { scale: 1.2, animation: true });
        } else {
            network.unselectAll();
            network.fit();
        }
    }
    
    // --- 5. ØªØºÛŒÛŒØ± Ù„ÛŒâ€ŒØ§ÙˆØª (Ø¬Ù‡Øª ØªØ³Øª) ---
    function toggleLayout() {
        var opts = { layout: { hierarchical: { enabled: !options.layout.hierarchical.enabled } } };
        // Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø¯Ú¯ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø¯Ù…Ùˆ ÙÙ‚Ø· Ø±ÛŒÙ„ÙˆØ¯ Ù…ÛŒÚ©Ù†ÛŒÙ…ØŒ ÙˆÙ„ÛŒ Ù…ÛŒØ´Ù‡ Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø¹ÙˆØ¶ Ú©Ø±Ø¯
        alert("Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ú©Ø§Ù…Ù„ Ú†ÛŒØ¯Ù…Ø§Ù† Ø¨ÛŒÙ† Ø¯Ø±Ø®ØªÛŒ Ùˆ Ø¢Ø²Ø§Ø¯ØŒ Ú©Ø¯ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¯Ø§Ø±Ø¯. ÙØ¹Ù„Ø§ ÙÙ‚Ø· Ø²ÙˆÙ… Ø±ÛŒØ³Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯.");
        network.fit();
    }

</script>

</body>
</html>